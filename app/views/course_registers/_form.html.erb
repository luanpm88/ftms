       <div class="row new_course_register_page">
            <div class="col-md-12">
              <div class="grid simple">
                <div class="grid-title no-border">
                  
                  
                </div>     
                
                
                
                
                <div class="grid-body no-border">
                  
                  
                  <% if @course_register.errors.any? %>
                    <div class="alert alert-error">
                      <button data-dismiss="alert" class="close"></button>
                      <div id="error_explanation">
                        <h5><%= pluralize(@course_register.errors.count, "error") %> prohibited this course register from being saved:</h5>
                  
                        <ul>
                        <% @course_register.errors.full_messages.each do |msg| %>
                          <li><%= msg %></li>
                        <% end %>
                        </ul>
                      </div>
                    </div>
                  <% end %>
                    
                 
                  
                  
                  <%= form_for(@course_register) do |f| %>
					
					<%= hidden_field_tag("tab_page", 1) if params[:tab_page] %>
                    
					
					
					 
					<h3>Course Registration</h3> 
					
					 
					<div class="phrase_box_list">
						 <% (0..9).each do |number| %>
							  <div class="row column-seperation phrase_box phrase_box_<%= number.to_s %> <%= 'hidden'.html_safe if number > 0 %>" rel="<%= number %>">
								   <div class="phrase_box_label">Course #<%= number+1 %></div>
								   <% if number != 0 %>
										<div class="phrase_box_close" rel="<%= number.to_s %>"><i class="icon icon-remove"></i></div>
								   <% end %>
								   <div class="col-md-12">
										<hr />
								   </div>
								   <div class="col-md-6">
										<div class="row">
											 <div class="col-md-5">													   
												  <div class="form-group">
													   <label class="form-label">Upfront?</label>
													   <span class="help"></span>
													   <div class="input-with-icon right">                                       
															<div class="radio radio-success" style="padding: 5px">
																 <input class="required" id="upfront_true_<%= number %>" type="radio" name="contacts_courses[<%= number %>][upfront]" value="true">
																 <label for="upfront_true_<%= number %>">Yes</label>
																 <input class="required" id="upfront_false_<%= number %>" type="radio" name="contacts_courses[<%= number %>][upfront]" value="false" checked="checked">
																 <label for="upfront_false_<%= number %>">No</label>
															</div>
													   </div>
												  </div>									
											 </div>
											 <div class="col-md-7">
												  <div class="form-group">
														<label class="form-label"><%= f.label :course %></label>
														<span class="help">(required)</span>
														<div class="input-with-icon  right">                                       
															 <i class=""></i>
															 <div class="input-with_add_but">
																  <%= link_to '<i class="icon-plus"></i>'.html_safe, new_course_path(tab_page: 1), title: "New Course", :class => 'btn btn-sm btn-small btn-white tab_page' %>
																  <input style="width:100%;margin-bottom: 5px;" name="contacts_courses[<%= number %>][course_id]" data="<%= courses_path(format: "json") %>" class="select2-ajax-courses main_input registration_course required" value="" text="" box_number="<%= number %>" />
															 </div>
														</div>
												  </div>
											 </div>
										</div>
										
										<div class="registration_course_price_box_<%= number %>"></div>
								   
										
								   </div>
								  <div class="col-md-6">
									   
											 
											 <div class="registration_phrase_box_<%= number %>">                                       
												  
												  
											</div>
									   	
								  </div>						 
							  </div>
							  
						 <% end %>
						 
						 <hr />
						 <a href="#add" class="btn btn-white add-more-course-form"><i class="icon icon-plus"></i> Add Course</a>
					</div>
					
					<br />
					
					<h3>Stock Registration</h3>
					
					<div class="stock_box_list">
						 <% (0..9).each do |number| %>
							  <div class="row column-seperation stock_box stock_box_<%= number.to_s %> <%= 'hidden'.html_safe if number >= 0 %>" rel="<%= number %>">
								   <div class="stock_box_label">Stock #<%= number+1 %></div>
								   <% if true %>
										<div class="stock_box_close" rel="<%= number.to_s %>"><i class="icon icon-remove"></i></div>
								   <% end %>
								   <div class="col-md-12">
										<hr />
								   </div>
								   <div class="col-md-3">
										<div class="form-group">
											 <label class="form-label"><label>Program</label></label>
											 <span class="help"></span>
											 <div class="input-with-icon date-group right">                                       
												  <i class=""></i>
												  <div class="input-with_add_but">
														 <%= link_to '<i class="icon-plus"></i>'.html_safe, new_course_type_path(tab_page: 1), title: "New Program", :class => 'btn btn-sm btn-small btn-white add-agent-button tab_page' %>
														 <input style="width:100%;margin-bottom: 5px;" name="program_id" data="<%= course_types_path(format: "json") %>" class="select2-ajax-course-types" value="" text="" box_number="<%= number %>" /> 
												  </div>
											 </div>
										</div>
								   </div>
								   <div class="col-md-3">
										<div class="form-group">
											 <label class="form-label"><label>Subject</label></label>
											 <span class="help"></span>
											 <div class="input-with-icon date-group right">                                       
												  <i class=""></i>
												  <div class="input-with_add_but">
														 <%= link_to '<i class="icon-plus"></i>'.html_safe, new_subject_path(tab_page: 1), title: "New Paper", :class => 'btn btn-sm btn-small btn-white add-agent-button tab_page' %>
														 <input style="width:100%;margin-bottom: 5px;" name="subject_id" data="<%= subjects_path(format: "json") %>" class="select2-ajax-subjects" value="" text="" box_number="<%= number %>" /> 
												  </div>
											 </div>
										</div>	
								   </div>
								   <div class="col-md-6">
										<div class="row">
											 <div class="col-md-8">
												  <div class="form_stock_list_<%= number %>"></div>
											 </div>
											 <div class="col-md-4">
												  <div class="form-group">
													   <label class="form-label"><label>Quantity</label></label>
													   <span class="help">(required)</span>
													   <div class="input-with-icon date-group right">                                       
															<i class=""></i>
															<div class="input-with_add_but">
																 <%= text_field_tag "books_contacts["+number.to_s+"][quantity]", 1, class: "form-control number_input_0 required text-center" %>
															</div>
													   </div>
												  </div>
											 </div>
										</div>
										<div class="form_stock_price_<%= number %>"></div>
								   </div>
								   <div class="col-md-5">
										<div class="form_volumn_list_<%= number %>"></div>
								   </div>
							  </div>
							  
						 <% end %>
						 
						 <hr />
						 <a href="#add" class="btn btn-white add-more-stock-form"><i class="icon icon-plus"></i> Add Stock</a>
						 <hr />
								   <div class="form-group">
											 <label class="form-label"><label>Delivery Address</label></label>
											 <span class="help">(required)</span>
											 <div class="input-with-iconz right">                                       
												  <%= f.text_field :mailing_address, :class => "form-control required" %>
											 </div>
								   </div>
					</div>
					
					<br />
					
					<h3>Student Information</h3> 
					
					<div class="row column-seperation">
						 <div class="col-md-12">
							  <div class="row">
								   <div class="col-md-3">
										
										<div class="form-group">
										  <label class="form-label"><%= f.label :student %></label>
										  <span class="help">(required)</span>
										  <div class="input-with-iconz right">
											 <input style="width:100%;margin-bottom: 5px;" name="course_register[contact_id]" data="<%= contacts_path(is_individual: true, format: "json") %>" class="select2-ajax-contacts required" value="<%= @contact.id %>" text="<%= @contact.display_name %>" />
											 <!--<div style="margin: 0;font-size: 18px;font-weight: bold"><strong><%= @contact.display_name %></strong></div>-->
										  </div>
										</div>
										
								   </div>
								   <div class="col-md-3">
										
										<div class="form-group">
										  <label class="form-label"><label>Deferred/Transferred Status</label></label>
										  <span class="help"></span>
										  <div class="input-with-iconz text-right">
											 <strong class="big-info">
												  <i class="icon icon-time"></i> <span class="transfer-total-hour"><%= format_price(@contact.budget_hour) %></span>
											 </strong>
											 <br />
											 <strong class="big-info">
												  $
												  <span class="transfer-total"><%= format_price(@contact.budget_money) %></span>
											 </strong>
										  </div>
										</div>
										
								   </div>								   
								   <div class="col-md-3">										
										<div class="form-group">
										  <label class="form-label"><label>Deferred/Transferred Used</label></label>
										  <span class="help"></span>
										  <div class="input-with-iconz text-right">
											 <strong class="big-info out_of_date">
												  <i class="icon icon-time"></i> <span class="transfer-used-hour">0</span>
												  <%= hidden_field_tag "course_register[transfer_hour]", 0 %>
											 </strong>
											 <br />
											 <strong class="big-info out_of_date">
												  $
												  <span class="transfer-used">0</span>
											 </strong>											 
										  </div>
										</div>
										
								   </div>
								   <div class="col-md-3">										
										<div class="form-group">
										  <label class="form-label"><label>Deferred/Transferred Remain</label></label>
										  <span class="help"></span>
										  <div class="input-with-iconz text-right">
											 <strong class="big-info paid">
												  <i class="icon icon-time"></i> <span class="transfer-remain-hour"><%= format_price(@contact.budget_hour) %></span>
											 </strong>
											 <br />
											 
											 <strong class="big-info paid">
												  $
												  <span class="transfer-remain"><%= format_price(@contact.budget_money) %></span>
											 </strong>
										  </div>
										</div>
										
								   </div>
							  </div>
						 </div>
					 </div>
					
					
					<br />
					
					<h3>Payment Information</h3> 
					
					
					<div class="row column-seperation">
						 <div class="col-md-5">
							  <div class="row">								   
								   <div class="col-md-6">										
										<div class="form-group">
										  <label class="form-label"><label>Receipt Date</label></label>
										  <span class="help">(required)</span>
										  <div class="input-with-icon  right">                                       
											   <i class=""></i>
											   <div class="input-append success date col-md-10 no-padding">
												 <%= f.text_field :created_date, :class => "form-control required", value: (@course_register.created_date.nil? ? "" : @course_register.created_date.strftime("%d-%b-%Y")) %>
												 <span class="add-on"><span class="arrow"></span><i class="icon-th"></i></span>
											   </div>
											   <br style="clear: both" />
										  </div>
										</div>
										
								   </div>							   
								   <div class="col-md-6">										
										<div class="form-group">
											 <label class="form-label"><label>Payment type</label></label>
											 <span class="help">(required)</span>
											 <div class="input-with-icon right">                                       
												  <select name="course_register[payment_type]" class="modern_select width100 required">
													   <option value="self-financed">Self-financed</option>
													   <option value="company-sponsored">Company-sponsored</option>
												  </select>
											 </div>
										</div>										
								   </div>
							  </div>
							  <div class="row">
								   <div class="col-md-6">													   
										<div class="form-group">
											 <label class="form-label"><%= f.label :bank_acount %></label>
											 <span class="help">(required)</span>
											 <div class="input-with-icon  right">                                       
												  <i class=""></i>
												  <div class="input-with_add_butz">												   													   
													   <%= select_tag 'course_register[bank_account_id]', options_for_select(BankAccount.active_bank_accounts.collect{ |u| [u.name, u.id] }), :include_blank => 'None', class: "modern_select width100 required" %>
												  </div>
											 </div>
										</div>					
								   </div>
								   <div class="col-md-6">										
										<div class="form-group">
											 <label class="form-label"><label>Discount Program</label></label>
											 <span class="help"></span>
											 <div class="input-with-icon right">                                       
												  <i class=""></i>
												   <div class="input-with_add_but">
													 <%= link_to '<i class="icon-plus"></i>'.html_safe, new_discount_program_path(tab_page: 1), title: "New Discount Program", :class => 'btn btn-sm btn-small btn-white tab_page' %>
													 <input style="width:100%;margin-bottom: 5px;" name="course_register[discount_program_id]" data="<%= discount_programs_path(format: "json") %>" class="select2-ajax-discount-programs" /> 
												   </div>
											 </div>
										</div>										
								   </div>
								   
							  </div>
							  
							  <div class="row">
								   <div class="col-md-6">
										<div class="form-group">
											 <label class="form-label"><label>Other discount/credit</label></label>
											 <span class="help"></span>
											 <div class="input-with-iconz right">                                       
												  <i class=""></i>
												   <div class="input-with_add_butz">
													 <%= text_field_tag "course_register[discount]", "", class: "form-control price_input price_discount" %>
												   </div>
											 </div>
										</div>
								   </div>
								   <div class="col-md-6">
										<div class="form-group">
										  <label class="form-label"><label>Debt Date</label></label>
										  <span class="help"></span>
										  <div class="input-with-icon  right">                                       
											   <i class=""></i>
											   <div class="input-append success date col-md-10 no-padding">
												 <%= f.text_field :debt_date, :class => "form-control" %>
												 <span class="add-on"><span class="arrow"></span><i class="icon-th"></i></span>
											   </div>
											   <br style="clear: both" />
										  </div>
										</div>
								   </div>
							  </div>
							  <div class="row">
								   <div class="col-md-6">
										<div class="form-group">
											 <label class="form-label"><label>Deferred/Transferred Amount</label></label>
											 <span class="help"></span>
											 <div class="input-with-iconz right">                                       
												  <i class=""></i>
												   <div class="input-with_add_butz">
													   <%= text_field_tag "course_register[transfer]", "", class: "form-control price_input price_transfer" %>
												   </div>
											 </div>
										</div>
								   </div>
								   <div class="col-md-6">
										<div class="form-group">
											 <label class="form-label"><%= f.label :invoice_required %></label>
											 <span class="help">(required)</span>
											 <div class="radio radio-success" style="padding: 5px">
												  <input class="invoice_required" id="invoice_yes" type="radio" name="course_register[invoice_required]" value="true" <% if @contact.invoice_required %>checked="checked"<% end %>>
												  <label for="invoice_yes">Yes</label>
												  <input class="invoice_required" id="invoice_no" type="radio" name="course_register[invoice_required]" value="false" <% if !@contact.invoice_required %>checked="checked"<% end %>>
												  <label for="invoice_no">No</label>
											 </div>
										</div>	
								   </div>
								   
							  </div>
							  <div class="row invoice-info-box">
								   <div class="col-md-6">
										<div class="form-group">
											 <label class="form-label"><label>VAT Address</label></label>
											 <span class="help"></span>
											 <div class="input-with-iconz right">                                       
												  <%= text_field_tag "course_register[vat_address]", @contact.vat_address, class: "form-control" %>
											 </div>
										</div>
								   </div>
								   <div class="col-md-6">
										<div class="form-group">
											 <label class="form-label"><label>VAT Name</label></label>
											 <span class="help"></span>
											 <div class="input-with-iconz right">                                       
												  <%= text_field_tag "course_register[vat_name]", @contact.vat_name, class: "form-control" %>
											 </div>
										</div>
								   </div>
								   <div class="col-md-6">
										<div class="form-group">
											 <label class="form-label"><label>VAT Code</label></label>
											 <span class="help"></span>
											 <div class="input-with-iconz right">                                       
												  <%= text_field_tag "course_register[vat_code]", @contact.vat_code, class: "form-control" %>
											 </div>
										</div>
								   </div>
							  </div>
						 </div>
						 <div class="col-md-7">
	 						  <div class="form-group">
								   <label class="form-label"><label>Total Price</label></label>
								   <span class="help"></span>
								   <div class="input-with-icon right">
										<table style="" class="table">
											 <tr>
												  <th>Type</th>
												  <th class="text-center">Count</th>
												  <th class="text-right">List Price</th>
												  <th class="text-right">Discount Program</th>
												  <th class="text-right">Other discount / credit</th>
												  <th class="text-right">Total</th>
											 </tr>
											 <tr>
												  <td class="text-left">Course</td>
												  <th class="text-center">
													   <strong class="total_course_count"></strong>
												  </th>
												  <td width="50%" class="text-right">
													   <strong class="total_course_list_price"></strong>
												  </td>
												  <td width="50%" class="text-right">
													   <strong class="total_course_discount_program_price"></strong>
												  </td>
												  <td width="50%" class="text-right">
													   <strong class="total_course_other_discount_price"></strong>
												  </td>

												  <td width="50%" class="text-right">
													   <strong class="total_course_price"></strong>
												  </td>
												  
											 </tr>
											 <tr>
												  <td class="text-left">Stock</td>
												  <th class="text-center">
													   <strong class="total_stock_count"></strong>
												  </th>
												  <td width="50%" class="text-right">
													   <strong class="total_stock_list_price"></strong>
												  </td>
												  <td width="50%" class="text-right">
													   <strong class="total_stock_discount_program_price"></strong>
												  </td>
												  <td width="50%" class="text-right">
													   <strong class="total_stock_other_discount_price"></strong>
												  </td>

												  <td class="text-right">
													   <strong class="total_stock_price"></strong>
												  </td>
											 </tr>
											 <tr>
												  <td class="text-right" colspan="5">Discount Program</td>
												  <td class="text-right">
													   <strong class="total_registration_discount_program"></strong>
												  </td>
											 </tr>
											 <tr>
												  <td class="text-right" colspan="5">Other discount/credit</td>
												  <td class="text-right">
													   <strong class="total_registration_discount"></strong>
												  </td>
											 </tr>
											 <tr>
												  <td class="text-right" colspan="5">Deferred/Transferred Amount</td>
												  <td class="text-right">
													   <strong class="total_registration_transfer"></strong>
												  </td>
											 </tr>
											 <tr>
												  <td class="text-right" colspan="5">Total</td>
												  <td class="text-right">
													   <strong class="total_registration_price"></strong>
													   <input type="text" name="total_valid" style="height: 1px;border: none;background: none;padding: 0;margin-top: -20px;" />
												  </td>
											 </tr>
										</table>
									   
								   </div>
							  </div>										
						 </div>
					 </div>
					 
						 
					<div class="form-actions">  
						 <div class="pull-right">
						 <button type="submit" class="btn btn-success btn-cons"><i class="icon-ok"></i> Save</button>
						  <%= link_to 'Cancel', users_path, :class => "btn btn-white btn-cons cancel-but" %>
					   </div>
					</div>
							  
						<% end %>
			   </div>
			 </div>
            </div>
			
      </div>

<script>
	 $(document).ready(function() {
		  jQuery.validator.addMethod("transfer", function(value, element) {
			   var remain = parseFloat($('.transfer-remain').html().replace(/,/g,""))
			   return remain >= 0.0
		  }, "Tranferred amout is not valid.");
		  jQuery.validator.addMethod("total", function(value, element) {
			   var total = parseFloat($('.total_registration_price').html().replace(/,/g,""))
			   return total >= 0.0
		  }, "Total amount is not valid. Please check again.");
		  
		  jQuery.validator.addMethod("total_course", function(value, element) {
			   var total = parseFloat($('.total_course_'+value).html().replace(/,/g,""))
			   return total >= 0.0
		  }, "Total amount is not valid. Please check again.");
		  
		  $("input[name='course_register[transfer]']").rules('add', {
			   transfer: true
		  });
		  $("input[name='total_valid']").rules('add', {
			   total: true
		  });
	 });
</script>
	 